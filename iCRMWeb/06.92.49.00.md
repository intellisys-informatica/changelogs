# iCRMWeb

# :file_folder: 06.92.49.00

## :memo: O que foi alterado?

<details open>
<summary>Resumo</summary>

- :star: Mensagem agrupada
- :star: Reimpressão de cupons
- :star: Relatório de Performance Campanha
- :star: Cadastrar Webhook iBank
- :star: Implementar relatório para apoio às análises de campanhas
- :star: Implementação de relatório de clientes - Painel Fidelização
- :arrow_up: Melhorar exibição das mensagens
- :arrow_up: Melhoria ao inserir campanha restrita
- :warning: Erro ao abrir página
- :warning: Analisar tipo de campanha
- :warning: Divergência de quantidade e valor em resultado da análise de vendas por produtos
- :warning: Erro análise de produtos encadeada sem dados ao visualizar resultado
- :warning: Erro ao consultar por classificação no Painel Fidelização

</details>

:star: Novo
:warning: Correção
:arrow_up: Melhoria

<details open>
<summary>Detalhes</summary>

:star: Mensagem agrupada

Implementação de funcionalidade para agrupamento de mensagens no sistema iCRMWeb.

Tarefa: 16146

---

:star: Reimpressão de cupons

Implementação de funcionalidade para reimpressão de cupons no sistema iCRMWeb.

Tarefa: 16186

---

:star: Relatório de Performance Campanha

Foi criada a página PAGE_ViewEstatisticasComparacaoCampanhaGame.

Tarefa: 16111

---

:star: Cadastrar Webhook iBank

Erro sem tratamento quando tenta rodar com o servidor desligado.

Foi feito também a parte de alteração.

Tarefa: 16197

---

:star: Implementar relatório para apoio às análises de campanhas

Implementado relatório conforme solicitado e utilizando a sentença disponibilizada por Ricardo. Ao entrar na tela de PAGE_TableCampanha, deve selecionar a campanha na tabela, clicar no botão "Clientes" e na tabela de clientes que abrirá abaixo, terá o botão "Relatório de Participação" onde é gerado esse novo relatório.

Necessário gerar a página PAGE_TableCampanha e o CRMImpressor.

Solicitação: 4627 | Tarefa: 16153

---

:star: Implementação de relatório de clientes - Painel Fidelização

Efetuado análise da solicitação. Efetuado inserção do novo botão Relatório 360. O botão Relatório 360 agenda a pg pgGeraXlsxRelatorio360Fidelizacao.

Essa pg gera um XLSX com 33 colunas do modo que o cliente solicitou.

Foi efetuado testes na base de desenvolvimento e o resultado foi anexado na solicitação.

Necessário gerar a página: PAGE_PainelFidelidade do projeto ICRM.
Necessário gerar o CRMImpressor.
Necessário efetuar testes juntamente com o cliente para verificar se a funcionalidade atende.

Solicitação: 4624 | Tarefa: 16176

---

:arrow_up: Melhorar exibição das mensagens

Melhoria na exibição das mensagens no sistema.

Tarefa: 16118

---

:arrow_up: Melhoria ao inserir campanha restrita

Configuração de restrição de campanha por usuário e/ou grupo em todas as telas de formulários de campanhas específicas.

Tarefa: 16180

---

:warning: Erro ao abrir página

Telas que não abrem (Página de Erro):
- Favoritos -> Banners
- Básico -> Plásticos -> Processos -> Gera Cartões Avulsos
- Básico -> Estatísticas -> Estatísticas de Mensagens
- Cheques -> Relatórios -> Consultas Divergentes
- Convênio -> Importação -> Importa Carga Convênio
- Convênio -> Importação -> Cancela Imp. Carga Convênio
- Convênio -> Importação -> Importação de Movimentos por Arquivo
- Convênio -> Combustível -> Relatório Convêniada Combustível
- Cartão Próprio -> Lançamentos -> Saque Emergencial
- Cartão Próprio -> Lançamentos -> Cancelamento Saque
- Cartão Próprio -> Processos -> Importação de Movimentos por Arquivo
- Cartão Próprio -> Processos -> Importa Arquivos Odonto Brasil
- Cartão Próprio -> Processos -> Arquivo DECRED
- Cartão Próprio -> Relatórios -> Perfil de Vendas Parceladas Analíticas
- Cartão Próprio -> Relatórios -> Consultas Divergentes
- Cartão Próprio -> Relatórios -> Relação de Saques
- Fidelização -> Processos -> Cupom SEFAZ

Tarefa: 16163

---

:warning: Analisar tipo de campanha

Verificado que estava passando fixo o primeiro código da CamDescontos no carregamento da página. Realizado adaptação para que funcione corretamente no inserir/alterar.

Necessário gerar as seguintes páginas:
- PAGE_FilterCampanha
- PAGE_FormCampanha
- PAGE_FormCampanha11
- PAGE_FormCampanha12
- PAGE_FormCampanha13
- PAGE_FormCampanha42
- PAGE_FormCampanha43
- PAGE_TableCampanha

Tarefa: 16181

---

:warning: Divergência de quantidade e valor em resultado da análise de vendas por produtos

Genimário atualizou as SPs sp_proccampanhaclientes e sp_atualizaanalizevendas e criou uma solução para alimentar o campo referente ao valor de desconto que chega pelas tabelas de Ricardo relacionadas ao Mensseger.

Solicitação: 4337 | Tarefa: 15939

---

:warning: Erro análise de produtos encadeada sem dados ao visualizar resultado

Foi constatado pela operadora Renata que no cliente PINHEIRO já está funcionando a funcionalidade de Análise de Produtos encadeada, talvez foi erro na época que a solicitação foi aberta mas por fatores externos.

Solicitação: 4370 | Tarefa: 15940

---

:warning: Erro ao consultar por classificação no Painel Fidelização

Problema no botão mala direta resolvido:

Substituído o alias da tabela cliente no case 1 de d para c, era o único que usava d.

Substituição da linha 226 de d.ClsCodigo para c.ClsCodigo.

Solicitação: 4527 | Tarefa: 16188

</details>

---

## :cd: Banco de dados

Houve alteração no banco de dados.

<details open>
<summary>Resumo</summary>

- Atualização das SPs sp_proccampanhaclientes e sp_atualizaanalizevendas

</details>

<details open>
<summary>Detalhes</summary>

Genimário atualizou as SPs sp_proccampanhaclientes e sp_atualizaanalizevendas e criou uma solução para alimentar o campo referente ao valor de desconto que chega pelas tabelas relacionadas ao Mensseger.

</details>

<details open>
<summary>Scripts</summary>
</details>

---

## :wrench: Configurações necessárias

Necessário gerar as seguintes páginas para a correção do tipo de campanha:
- PAGE_FilterCampanha
- PAGE_FormCampanha
- PAGE_FormCampanha11
- PAGE_FormCampanha12
- PAGE_FormCampanha13
- PAGE_FormCampanha42
- PAGE_FormCampanha43
- PAGE_TableCampanha

Para o relatório de participação:
- Necessário gerar a página PAGE_TableCampanha e o CRMImpressor

Para o relatório 360 de fidelização:
- Necessário gerar a página PAGE_PainelFidelidade do projeto ICRM
- Necessário gerar o CRMImpressor
- Necessário efetuar testes juntamente com o cliente
